---
title: "Alternatif Jawaban: Permasalahan Pemenuhan ATK Office"
subtitle: "Workshop Melek Data"
date: "`r format(Sys.Date(),'%d %B %Y')`"
author: "Departemen Market Research - Nutrifood Indonesia"
format: 
  html:
    theme: darkly
    toc: true
    toc-depth: 4
    toc-expand: 3
    toc-title: "Daftar Isi"
    toc-location: right
    html-math-method: katex
    code-fold: true
    code-line-numbers: true
    code-summary: "Buka Skrip!"
    embed-resources: true
    self-contained-math: true
editor: visual
---

```{r, include=FALSE}
setwd("~/melek-data/Problems/ATK/Alternatif Jawaban")

rm(list=ls())
library(readxl)
library(dplyr)
library(ggplot2)
```

# Pendahuluan

## Latar Belakang

Salah satu tugas dari tim *office* adalah *supporting another department* dalam hal kebutuhan sarana dan prasarana kerja, termasuk ke dalam pemenuhan kebutuhan **alat tulis kantor**. Setiap harinya, *user* di masing-masing departemen bisa melakukan *request* **alat tulis kantor** menggunakan sistem IT yang ada. Setiap *request* tersebut dicatat secara otomatis. Setelah itu, tim *office* **wajib memenuhi** *request* tersebut dan menuliskan rekap pemberian (serah terima) tersebut secara harian.

Data-data ini disimpan secara rapi namun belum pernah terutilisasi lebih lanjut.

## Data yang Dimiliki

Pada *folder* ini kalian akan menemukan dua buah *files* berformat `.xlsx`, yakni:

### **Data I**: `dbase pengeluaran produk.xlsx`

`dbase pengeluaran produk.xlsx`, yakni transaksi harian pemberian produk **alat tulis kantor** yang dilakukan tim *office* kepada orang yang meminta (*request*) di masing-masing departemen. Berikut adalah sampel dari data yang ada:

```{r}
df = read_excel("~/melek-data/Problems/ATK/dbase pengeluaran produk.xlsx")
df[1:10,] |> knitr::kable()
```

Struktur datanya sebagai berikut:

```{r}
str(df)
```

### **Data II**: `dbase pembelian produk.xlsx`

`dbase pembelian produk.xlsx`, yakni transaksi harian pembelian produk **alat tulis kantor** yang dilakukan tim *office* kepada *supplier*. Berikut adalah sampel datanya:

```{r}
df = read_excel("~/melek-data/Problems/ATK/dbase pembelian produk.xlsx")
df[1:10,] |> knitr::kable()
```

Struktur datanya sebagai berikut:

```{r}
str(df)
```

---

# Masalah

## *Problem Statement*

Masalah yang dihadapi oleh tim *office* adalah:

-   Jika semua produk overstok, maka **bisa jadi** ada kemungkinan barang terlalu lama "parkir" di gudang dan tidak terpakai.
-   Jika semua produk understok, maka *user* akan gelisah menunggu kapan *request*-nya bisa didapatkan.

Oleh karena itu, menggunakan data-data yang ada:

> Bantu tim *office* membuat strategi ***inbound - outbound*** (pemenuhan stok) yang optimal!

Buat **satu materi presentasi sederhana** yang bisa menjelaskan **ide dan strategi tim Anda!** Silakan gunakan *tools* pengolahan data sesuai dengan preferensi tim Anda!

Catatan: data ini dirancang untuk bisa diselesaikan cukup dengan `Ms. Excel`.

## *Discussion*

Apakah ada:

-   Variabel dari data yang tidak digunakan dalam membuat strategi tersebut?
-   Variabel yang belum ada pada data namun diperlukan dalam membuat strategi tersebut? Jika ada, sebutkan dan bahas dalam materi presentasi tim Anda!
-   Asumsi yang tim Anda gunakan dalam membuat strategi tersebut?

## *Hints*

Untuk membantu menyelesaikan masalah ini, Anda bisa mempertimbangkan untuk melakukan beberapa hal berikut ini:

1.  Membuat pre-analisa berupa analisa deskriptif dari kedua data tersebut.
2.  Strategi yang bisa dipertimbangkan: *cost efficiency* atau *service level*.
3.  ***Keep it simple!*** Seringkali masalah yang terlihat rumit dan kompleks sebenarnya bisa diselesaikan dengan pendekatan sederhana jika kita benar-benar bisa menyesuaikan tujuan dengan metode atau analisa yang digunakan.
4.  Melakukan transformasi kepada data yang memiliki *range* yang sangat lebar. Transformasi yang bisa dilakukan antara lain:

*Scaling* dengan formula berikut:

$$\hat{X} = \frac{X-\bar{X}}{X_{max}-X_{min}}$$

*Standardization* dengan formula berikut:

$$\hat{X} = \frac{X-\bar{X}}{\sigma_X}$$

Fungsi logaritmik dengan formula berikut:

$$\hat{X} = \log{X}$$

Fungsi transformasi *Tukey* lainnya.

___Selamat Mengerjakan!___

*Notes:* Setiap tim diperbolehkan bertanya kepada *observer* sebanyak **tiga kali!**

---

# Alternatif Jawaban

Permasalah di atas bisa diselesaikan dengan berbagai macam jawaban. Asumsi yang dipakai juga bisa beragam. Namun, walaupun tidak ada jawaban benar dan salah, kita tetap bisa menguji apakah asumsi yang kita gunakan logis atau tidak.

Pada bagian ini, kami memberikan __satu alternatif jawaban__ yang bisa digunakan.

## Tujuan

Tujuan utama dari analisa ini adalah memberikan masukan berupa strategi pemenuhan ATK tim _office_, yakni bagaimana melakukan _inbound_ dan _outbound_ dari ATK yang ada. 

__Kunci pemenuhan ATK__ terletak dari bagaimana tim _office_ membeli dan melakukan proses _stocking_ yang baik. Oleh karena itu, kami tidak menggunakan _dataset_ pembelian ATK. Kami hanya mengambil variabel harga dari masing-masing ATK dari _dataset_ tersebut.

Untuk bisa membeli dengan tepat, kita bisa membagi seluruh ATK menjadi kelompok-kelompok sesuai dengan karakteristiknya. Pada analisa ini, kami membagi ATK sesuai dengan:

1. __Harga__ dan
1. __Banyaknya__ ___request___ terhadap ATK tersebut pada tahun 2023. Kenapa _range_ waktunya dipersempit? 

> Kita bisa melakukan beberapa pre-analisa terlebih dahulu.

### Pre-Analisa

#### Data Pembelian ATK

```{r,fig.align='center',fig.retina=8}
# kita panggil datanya
df_1 = read_excel("~/melek-data/Problems/ATK/dbase pembelian produk.xlsx")

# buat default periodenya
periode_default = c(paste(1:12,2018,sep = "-"),
                    paste(1:12,2019,sep = "-"),
                    paste(1:12,2020,sep = "-"),
                    paste(1:12,2021,sep = "-"),
                    paste(1:12,2022,sep = "-"),
                    paste(1:12,2023,sep = "-"))

# kita enrich dulu untuk perhitungan
df_1 = 
  df_1 |>
  mutate(bulan = lubridate::month(tanggal),
         tahun = lubridate::year(tanggal)) |>
  mutate(periode = paste(bulan,tahun,sep = "-"),
         periode = factor(periode,levels = periode_default))

# plot pertama
df_1 |>
  group_by(periode) |>
  summarise(beli = sum(total_beli)) |>
  ungroup() |>
  mutate(label = beli / 10^6,
         label = round(label,1),
         label = paste0("Rp",label,"jt")) |>
  ggplot(aes(x = periode,
             y = beli)) +
  geom_line(group = 1,color = "steelblue") +
  geom_text(aes(label = label),alpha = .5,size = 1.5) +
  scale_x_discrete(guide = guide_axis(n.dodge=4)) +
  theme_minimal() +
  labs(title = "Trend Pembelian ATK per Bulan",
       subtitle = "Sumber: data pembelian ATK",
       x = "Periode",
       y = "Total Pembelian (Rp)") +
  theme(axis.text.y = element_blank())

# plot tentang harga per jenis satuan barang ATK
df_1 |>
  mutate(satuan = tolower(satuan),
         satuan = trimws(satuan)) |>
  select(satuan,harga_beli) |>
  distinct() |>
  mutate(harga_beli = as.numeric(harga_beli)) |>
  group_by(satuan) |>
  summarise(min = min(harga_beli),
            max = max(harga_beli),
            mean = mean(harga_beli,na.rm = T)) |>
  ungroup() |>
  ggplot() +
  geom_errorbar(aes(x = satuan,ymin = min,ymax = max),
                width = .2) +
  geom_point(aes(x = satuan,y = mean),shape = 4,color = "darkred") +
  labs(title = "Range Harga ATK per Jenis Satuannya") +
  theme_minimal() +
  labs(subtitle = "Sumber: data pembelian ATK",
       x = "Jenis Satuan ATK",
       y = "Range Harga (Rp)")
```

#### Data Pengeluaran Produk

```{r}
df_2 = read_excel("~/melek-data/Problems/ATK/dbase pengeluaran produk.xlsx")
```



## Langkah Pengerjaan

